(function(){"use strict";angular.module("handsomemanApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","pascalprecht.translate","services","angular-carousel","angularFileUpload","angularSpinner"]).config(["$routeProvider","$translateProvider",function(a,b){return a.when("/",{templateUrl:"views/top.html",controller:"TopCtrl"}).when("/imageSelect",{templateUrl:"views/image_select.html",controller:"ImageSelectCtrl"}).when("/question",{templateUrl:"views/question.html",controller:"QuestionCtrl"}).when("/result",{templateUrl:"views/result.html",controller:"ResultCtrl"}).when("/setAnotherImage",{templateUrl:"views/set_another_image.html",controller:"NewImageCtrl"}).otherwise({redirectTo:"/"}),b.useStaticFilesLoader({prefix:"scripts/i18n/",suffix:".json"}),b.preferredLanguage("kr"),b.useMissingTranslationHandlerLog()}]).run(["$window","$rootScope","$location","$translate",function(a,b,c,d){return console.log("app start"),b.login=!1,b.go=function(a){return c.path(a)},window.fbAsyncInit=function(){var a;a=function(a){"connected"===a.status&&FB.api("/me",function(a){var c,e;return console.log("logined"),console.log(a),b.login=!0,b.facebookData=a,console.log(a.locale),"ja_JP"===a.locale?(d.use("jp"),c=angular.element(document.querySelector("head")),c.append("<link rel='stylesheet' href='styles/jp-font.css'>"),e=angular.element(document.getElementsByClassName("main")),b.bgImgURL="../images/minam_bg_800x600-01_jp.png"):(d.use("kr"),b.bgImgURL="../images/minam_bg_800x600-01.png",b.$apply())})},FB.init({appId:"1481265362129848",xfbml:!0,version:"v2.1"}),FB.getLoginStatus(function(b){"connected"===b.status?a(b):FB.login(function(b){a(b)},{scope:"publish_actions, email"})})},function(a,b,c){var d,e;e=void 0,d=a.getElementsByTagName(b)[0],a.getElementById(c)||(e=a.createElement(b),e.id=c,e.src="//connect.facebook.net/en_US/sdk.js",d.parentNode.insertBefore(e,d))}(document,"script","facebook-jssdk"),b.$on("$routeChangeStart",function(a,c){b.login===!1&&c.templateUrl&&c.templateUrl.indexOf("top.html")<0&&b.go("/")})}])}).call(this),function(){"use strict";angular.module("handsomemanApp").controller("TopCtrl",["$scope","$rootScope","$translate","Util",function(a,b,c,d){return b.share_check=!0,b.imageSrc="",d.makeReq("get","runCount","").success(function(b){return a.runCount=b.count}).error(function(){return console.log("error")}),a.toggleCheckBox=function(){return b.share_check=!b.share_check},a.images=[{image:"John"},{image:"John"},{image:"John"}]}])}.call(this),function(){"use strict";angular.module("handsomemanApp").controller("ResultCtrl",["$scope","$rootScope","Util","$translate",function(a,b,c,d){var e,f,g,h;return g="https://play.google.com/store/apps/details?id=com.easi6.tomoni",f="https://itunes.apple.com/",h="code="+b.UploadedFileCode+"&nation=","ja_JP"===b.facebookData.locale?(f+="kr/app/tomoni/id826972115",h+="1"):(f+="jp/app/tomoni/id826972115",h+="0"),a.resultImageSrc=c.serverUrl()+"/"+b.sharedImageUrl,d("SHARE_SENTENCE").then(function(c){return a.shareMsg=c,b.share_check?(a.widthRerun="60%",a.shareImage()):(a.widthRerun="40%",a.widthShare="20%")}),a.GoToApp=function(){var a,b;return a="",b=navigator.userAgent.toLowerCase(),b.indexOf("iphone")>0||b.indexOf("ipod")>0?(console.log("ios"),a=f):b.indexOf("android")>0?(console.log("android"),a=g):(console.log("etc"),a=g),window.open(g)},a.ReRun=function(){return b.go("/")},e=function(b){var d;return d={message:a.shareMsg+"\n http://minam.easi6.com/",picture:c.serverUrl()+"/"+b.imageUrl},FB.api("/me/feed","post",d,function(a){return console.log(!a||a.error?"Error occured":"Post ID: "+a.id)})},a.shareImage=function(){return c.makeReq("post","fbShare",h).success(function(a){return console.log(a),e(a)}).error(function(){return console.log("error")})}}])}.call(this),function(){"use strict";angular.module("handsomemanApp").controller("QuestionCtrl",["$scope","$q","$interval","$translate","$timeout","$rootScope","Util",function(a,b,c,d,e,f,g){var h,i,j,k,l,m;return console.log(d.use()),console.log("question"),l="code="+f.UploadedFileCode,a.gotSharedImageFlg=!1,h=function(b){var c,d,e,f;return e=b.no,c=b.yes,f=Math.round(100*e/(e+c)),d=100-f,a.uglyWidth=f+"%",a.uglyPercent=a.uglyWidth,a.handsomeWidth=d+"%",a.handsomePercent=a.handsomeWidth},f.sendDataForSharedImage=l+"&retry="+f.Retry+"&fbId="+f.facebookData.email+"&nation=",f.sendDataForSharedImage="ja_JP"===f.facebookData.locale?f.sendDataForSharedImage+"1":f.sendDataForSharedImage+"0",g.makeReq("post","sharedImage",f.sendDataForSharedImage).success(function(b){return console.log("suc"),console.log(b),b.status<0?f.go("/setAnotherImage"):(f.sharedImageUrl=b.imageUrl,a.gotSharedImageFlg=!0)}).error(function(){return console.log("error")}),g.makeReq("post","questionResult",l).success(function(a){return console.log("question result suc"),console.log(a),h(a)}).error(function(){return console.log("error")}),k="",j="",d("BTN_RESULT_MAKING").then(function(b){a.loadingMsg=b,j=b}),a.ChangeRadio=function(b){return console.log(b),a.answer=b},i=function(){if("...."===k){if(k="",a.gotSharedImageFlg===!0)return c.cancel(m),void d("BTN_RESULT_END").then(function(b){return a.loadingMsg=b})}else k+=".";return a.loadingMsg=j+k},m=c(i,1e3),a.Answered=function(){var b;return a.showGraph=!0,b=l+"&answer="+a.answer,g.makeReq("post","question",b).success(function(a){return console.log(a)}).error(function(){return console.log("error")})},a.GoToResult=function(){return a.showGraph===!0?f.go("/result"):void 0}}])}.call(this),function(){"use strict";angular.module("handsomemanApp").controller("ImageSelectCtrl",["$scope","fileReader","$translate","$rootScope","Util","$upload","usSpinnerService",function(a,b,c,d,e,f,g){return console.log(b),a.getFile=function(){b.readAsDataUrl(a.file,a).then(function(a){d.imageSrc=a})},a.imageProcess=function(){var a;return d.imageSrc?(a=e.dataURItoBlob(d.imageSrc),g.spin("spinner-1"),f.upload({url:""+e.serverUrl()+"/imageUpload",file:a}).success(function(a){return console.log(a),g.stop("spinner-1"),d.UploadedFileCode=a.code,d.Retry=a.retry,d.go("question")}).error(function(){return console.log("error"),g.stop("spinner-1")})):c("INSERT_PHOTO").then(function(a){alert(a)})}}]),angular.module("handsomemanApp").directive("ngFileSelect",function(){return{link:function(a,b){b.bind("change",function(b){a.file=(b.srcElement||b.target).files[0],a.getFile()})}}})}.call(this),function(){"use strict";angular.module("handsomemanApp").controller("NewImageCtrl",["$scope","$rootScope","Util","$translate",function(a,b){return a.imageSrc="ja_JP"===b.facebookData.locale?"../images/new_image_jp.png":"../images/new_image.png"}])}.call(this),angular.module("services",[]).constant("API_PORT",3001).constant("API_HOST","https://minam.easi6.com"),function(){angular.module("services").factory("Host",["$window","API_HOST","API_PORT",function(a,b,c){var d,e,f;return e=b,null!=a.localStorage&&(d=a.localStorage.getItem("api_host"),console.log("localstorage host = "+d),d&&""!==d&&(e=d)),f=c,{getAPIHost:function(){return e},getAPIPort:function(){return f},setAPIPort:function(a){return console.log("set api port! host = "+a),f=a}}}])}.call(this),function(){angular.module("services").factory("fileReader",["$q","$log",function(a){var b,c,d,e,f;return d=function(a,b,c){return function(){c.$apply(function(){b.resolve(a.result)})}},c=function(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}},e=function(a,b){return function(a){b.$broadcast("fileProgress",{total:a.total,loaded:a.loaded})}},b=function(a,b){var f;return f=new FileReader,f.onload=d(f,a,b),f.onerror=c(f,a,b),f.onprogress=e(f,b),f},f=function(c,d){var e,f;return e=a.defer(),f=b(e,d),f.readAsDataURL(c),e.promise},{readAsDataUrl:f}}])}.call(this),function(){angular.module("services").factory("Util",["$q","$http","$window","Host","$rootScope","$upload",function(a,b,c,d){return{serverUrl:function(){return""+d.getAPIHost()+":"+d.getAPIPort()},makeReq:function(a,c,e){return console.log(""+d.getAPIHost()+":"+d.getAPIPort()+"/"+c),b[a](""+d.getAPIHost()+":"+d.getAPIPort()+"/"+c,"get"===a?{params:e}:e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},dataURItoBlob:function(a){var b,c,d,e;for(b=void 0,b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):unescape(a.split(",")[1]),e=null!=a.split(",")[0].split(":")[1].split(";")[0],d=new Uint8Array(b.length),c=0;c<b.length;)d[c]=b.charCodeAt(c),c++;return new Blob([d],{type:e})}}}])}.call(this);